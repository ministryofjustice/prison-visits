:css
  table {
    border-collapse: collapse;
  }

  = t("metrics.td")
    = t("metrics.text_align_right")
    = t("metrics.min_width_2em")
  = t("metrics.unknown_2")

  .prison-name= t("metrics.unknown_1")
    = t("metrics.text_align_left")
  = t("metrics.unknown_2")

  .even= t("metrics.unknown_1")
    = t("metrics.background_color_lightgray")
  = t("metrics.unknown_2")

  .total= t("metrics.td")
    = t("metrics.border_thin_solid_black")
  = t("metrics.unknown_2")

%h1
  = t("metrics.visits_confirmed_by_week")
  = link_to('CSV', format: :csv)

%table
  %tr
    %th
      = t("metrics.prison")
    - @dataset.week_range.each do |week_no|
      %th
        = @start_of_year + week_no * 7
  %tr.total
    %td.prison-name
      = t("metrics.total_1")
    - @dataset.week_range.each do |week_no|
      %td
        = @dataset.total[week_no]
  - @nomis_ids.each_with_index do |nomis_id, i|
    %tr{class: i.even? ? 'even' : 'odd'}
      %td.prison-name
        = prison_name_for_id(nomis_id)
      - @dataset.week_range.each do |week_no|
        %td
          = @dataset.for_nomis_id(nomis_id)[week_no]
